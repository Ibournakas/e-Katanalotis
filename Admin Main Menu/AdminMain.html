<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>    
    <title>Μενού Διαχειριστή</title>

    <style>

        body::before{
            content: "";
            background: url("images/supermarket.jpg");
            opacity: 0.07;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            position: absolute;
            z-index: -1;  
        }

        #leaderboard_tbl{
            margin-top: 4%;
            margin-left: auto;
            margin-right: auto;
            border-collapse: collapse;
            background-color: rgb(52, 139, 232, 0.45); 
            border-radius: 3px;
        }

        th,td{
            text-align: center;
            padding: 10px 25px 10px 25px;
        }

        tr{border-bottom: 2px ridge black;}

        
        #updProd, #delProd, #show_stats_btn,#leaderboard_btn, #updPOIs,
        #delPOIs, #usermenu, #previous, #next, #logout{
                margin-top: 12px;
                margin-right: 20px;
                padding: 10px 20px 10px 20px;
                border-width: 1px;
                border:none;
                border-radius: 7px;
                background-color: darkblue;
                color: rgb(178, 242, 242);
            }

        #logout{
            color:white;
            background-color: rgb(212, 0, 0);
            display: inline;
            margin-left: 27%;
            margin-top: 35%;
        }

        #updProd{
            margin-left: 10px;
        }

        #updProd:hover, #delProd:hover, #leaderboard_btn:hover,
        #updPOIs:hover, #delPOIs:hover, #usermenu:hover, #previous:hover,
        #next:hover, #logout:hover, #show_stats_btn:hover{
            cursor: pointer;
            opacity: 0.85;
        }

        #previous, #next{
            visibility:hidden;
            padding: 5px 10px 5px 10px;
            margin: 5px;
            margin-top: 10px;
        }

        #previous{
            margin-left:47%;     
        }

    </style>  

  
</head>
<body>
    <button id="updProd" onclick="insertupdatedata()">Ανέβασμα προϊόντων</button>
    <button id="delProd" onclick="deletedata()">Διαγραφή προϊόντων</button>
    <button id="show_stats_btn" onclick="gotostats()">Προβολή Στατιστικών</button>
    <button id="leaderboard_btn" onclick="showleader()">Προβολή Leaderboard</button>
    <button id="updPOIs" onclick="insertupdatepois()">Ανέβασμα POIs</button> 
    <button id="delPOIs" onclick="deletepois()">Διαγραφή POIs</button> 
    <button id="usermenu" onclick="usermenu()">Μενού χρήστη</button> 
    <div id="leaderboard"></div>
        <button id="previous" onclick="select_prev()">&#x2190</button>
        <button id="next" onclick="select_next()">&#x2192</button>
    <button id="logout" onclick="logout()">Αποσύνδεση</button>
    
    <script>


///if username not set or session expired, go back to login page        
var username = null; //get current user's username
        xhttp = new XMLHttpRequest();
        xhttp.onload = function() {
            if (this.readyState == 4 && this.status == 200) {
                username = this.responseText;
                if(username == '') window.location.replace("Login.html");
                }
            };
        xhttp.open("GET", "LoginForm.php?functionToCall=getUsername", true);
        xhttp.send();  
        

        function deletedata() {
            if(confirm("Θέλετε σίγουρα να διαγράψετε όλα τα δεδομένα;")){  
                var xhttp = new XMLHttpRequest();
                xhttp.onload = function() {
                        if (this.readyState == 4 && this.status == 200) 
                            alert("Διαγράφηκε!");
                        };
                xhttp.open("GET", "insert_delete_prodData.php?functionToCall=delete", true);
                xhttp.send();}
        }
         
        function insertupdatedata() {
          var xhttp = new XMLHttpRequest();
          xhttp.onload = function() {
                if (this.readyState == 4 && this.status == 200) 
                    alert("Ενημερώθηκε!");
                };
          xhttp.open("GET", "insert_delete_prodData.php?functionToCall=insert_update", true);
          xhttp.send();
        }

        function showleader() {
            if(leaderboard_btn.innerHTML == "Προβολή Leaderboard"){  // case = show leaderboard
                leaderboard_btn.innerHTML = "Απόκρυψη Leaderboard"
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.onload = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("leaderboard").innerHTML = this.responseText;
                    document.getElementById("logout").style.marginTop = '0%';
                    document.getElementById("previous").style.visibility = "visible";
                    document.getElementById("next").style.visibility = "visible";
                    }
                };
                xmlhttp.open("GET","Leaderboard.php?functionToCall=sessiondestroy",true);  
                xmlhttp.send();
            }
            else {                                                // case = hide leaderboard
                document.getElementById("logout").style.marginTop = '35%';
                document.getElementById("previous").style.visibility = "hidden";
                document.getElementById("next").style.visibility = "hidden";
                leaderboard_btn.innerHTML = "Προβολή Leaderboard"
                document.getElementById("leaderboard").innerHTML = " ";
            }}
    
        
        function select_next() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onload = function() {
            if (this.readyState == 4 && this.status == 200) {
                document.getElementById("leaderboard").innerHTML = " ";
                document.getElementById("leaderboard").innerHTML = this.responseText;
                }
            };
            xmlhttp.open("GET","Leaderboard.php?functionToCall=selectnext",true);
            xmlhttp.send();
        }


        function select_prev() {
            var xhttp = new XMLHttpRequest();
            xhttp.onload = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("leaderboard").innerHTML = " ";
                    document.getElementById("leaderboard").innerHTML = this.responseText;
                    }
                };
            xhttp.open("GET", "Leaderboard.php?functionToCall=selectprev", true);
            xhttp.send();
            }


        function deletepois() {
        if(confirm("Θέλετε σίγουρα να διαγράψετε όλα τα δεδομένα;")){
            var xhttp = new XMLHttpRequest();
            xhttp.onload = function() {
                    if (this.readyState == 4 && this.status == 200) 
                        alert("Διαγράφηκε!");
                    };
            xhttp.open("GET", "insert_delete_poiData.php?functionToCall=delete", true);
            xhttp.send();}   
        }    


        function insertupdatepois() {
          var xhttp = new XMLHttpRequest();
          xhttp.onload = function() {
                if (this.readyState == 4 && this.status == 200) 
                    alert("Ενημερώθηκε!");
                };
          xhttp.open("GET", "insert_delete_poiData.php?functionToCall=insert_update", true);
          xhttp.send();
        }


        function usermenu(){
            window.location.href = "UserMain.html";
        }


        function logout(){
            //call php file to destroy session, then move to Login page
            if(confirm("Θέλετε σίγουρα να αποσυνδεθείτε;")){
            var xhttp = new XMLHttpRequest();
            xhttp.onload = function() {
                    if (this.readyState == 4 && this.status == 200) 
                        window.location.href = "Login.html";
                    };
            xhttp.open("GET", "Logout.php", true);
            xhttp.send();
        }}


        function gotostats()
        {window.location.href = "Stats.html";}

    </script>

</body>
</html>